#!/usr/bin/env bash

# Usage for the switch command and its sub commands
# --------------------------------------------------------------------------------------------------
switch::usage()
{
    cat <<USAGE
Usage:
  switch [OPTIONS] [COMMAND] [ARGS...]

Options:
  -h, --help        Print out usage
USAGE

    log::ln "\nExamples:"
    log::subln "Switch system version: ${green}./${SCRIPT} switch ${none}"
    echo
    exit
}


# Parse the switch commands and execute
# --------------------------------------------------------------------------------------------------
switch::run()
{
    utils::help "$@" "switch::usage"

    # Parse the switch commnand
    local command=$1; shift
    case "$command" in
        repo) switch::repo ;;
        *) log::error "Invalid switch command: ${cyan}${command}${none}"; switch::usage ;;
    esac
}

# switch up nix store
# --------------------------------------------------------------------------------------------------
switch::repo()
{
    local remote=$(git remote)
    local url=$(git config --get remote.${remote}.url)
    if [[ "$url" =~ .*/(.*)/(.*) ]]; then 
        local owner="${BASH_REMATCH[1]}"
        local repo="${BASH_REMATCH[2]}"
        git remote set-url ${remote} "git@github.com:${owner}/${repo}"
    else
        log::error "Unable to parse the remote URL: ${cyan}${remote}${none}"
    fi
}
